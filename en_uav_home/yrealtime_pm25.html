<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>Artcore - Services</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <script type="text/javascript" src="js/move-top.js"></script>
        <script type="text/javascript" src="js/easing.js"></script>
        <script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/font-awesome.css">
        <link rel="stylesheet" href="css/animate.css">
        <link rel="stylesheet" href="css/templatemo-misc.css">
        <link rel="stylesheet" href="css/templatemo-style.css">
        <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <script src="js/jquery.min.js"></script>
        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="#/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <section id="pageloader">
            <div class="loader-item fa fa-spin colored-border"></div>
        </section> <!-- /#pageloader -->

        <header class="site-header container-fluid">
            <div class="top-header">
                <div class="logo col-md-6 col-sm-6">
                    <h1><a href="index.html"><em>无人机</em>环境监测</a></h1>
                    <span>by PYX小组</span>
                </div> <!-- /.logo -->
            </div> <!-- /.top-header -->
            <div class="main-header">
                <div class="row">
                    <div class="main-header-left col-md-3 col-sm-6 col-xs-8">
                        <a id="search-icon" class="btn-left fa fa-search" href="#search-overlay"></a>
                        <div id="search-overlay">
                            <a href="#search-overlay" class="close-search"><i class="fa fa-times-circle"></i></a>
                            <div class="search-form-holder">
                                <h2>Type keywords and hit enter</h2>
                                <form id="search-form" action="#">
                                    <input type="search" name="s" placeholder="" autocomplete="off" />
                                </form>
                            </div>
                        </div><!-- #search-overlay -->
                    </div> <!-- /.main-header-left -->
                    <div class="menu-wrapper col-md-9 col-sm-6 col-xs-4">
                        <a href="#" class="toggle-menu visible-sm visible-xs"><i class="fa fa-bars"></i></a>
                        <ul class="sf-menu hidden-xs hidden-sm">
                            <li><a href="index.html">首页</a></li>
                            <li class="active"><a href="services.html">无人机地图数据</a></li>
                            <li><a href="http://localhost:8090/en_uav_cam/uavcam.html">现场视频</a></li>
                            <li><a href="ylogin_register.html">管理员</a>
                            <li><a href="#">实时数据可视化</a>
                              <ul>
                              <li><a href="yrealtime_tem_hum.html">温湿度实时数据</a></li>
                              <li><a href="yrealtime_pm25.html">pm25实时数据</a></li>
                            </ul>
                            </li>
                            </li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                    </div> <!-- /.menu-wrapper -->
                </div> <!-- /.row -->
            </div> <!-- /.main-header -->
            <div id="responsive-menu">
                <ul>
                    <li><a href="index.html">首页</a></li>
                    <li><a href="services.html">无人机地图数据</a></li>
                    <li><a href="http://localhost:8090/en_uav_cam/uavcam.html">现场视频</a></li>
                    <li><a href="ylogin_register.html">管理员</a>
                    <li><a href="#">实时数据可视化</a>
                      <ul>
                      <li><a href="yrealtime_tem_hum.html">温湿度实时数据</a></li>
                      <li><a href="yrealtime_pm25.html">pm25实时数据</a></li>
                      </ul>
                    </li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
        </header> <!-- /.site-header -->




              <div class="content-wrapper">

                    <!-- //pricing -->

                    <div id="pricing1" class="pricing1">
                    <div class="container">
                      <h3>实时pm25变化</h3>
                      <div id="main2" style="height:400px"></div>
                      <!-- ECharts单文件引入 -->
                      <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
                      <script type="text/javascript">
                          // 路径配置
                          require.config({
                              paths: {
                                  echarts: 'http://echarts.baidu.com/build/dist'
                                  //echarts: '../src'
                              }
                          });
                          var myChart2;
                          // 使用
                          require(
                              [
                                  'echarts',
                                  'echarts/chart/line'
                                  //'echarts/chart/bar' // 使用柱状图就加载bar模块，按需加载
                              ],

                              function (ec) {
                                  // 基于准备好的dom，初始化echarts图表
                                  myChart2 = ec.init(document.getElementById('main2'));

                                  option = {
                                            title : {
                                                text: 'pm25变化',
                                                subtext: '无人机真实测量'
                                            },
                                            tooltip : {
                                                trigger: 'axis'
                                            },
                                            legend: {
                                                data:['pm25']
                                            },
                                            toolbox: {
                                                show : true,
                                                feature : {
                                                    mark : {show: true},
                                                    dataView : {show: true, readOnly: false},
                                                    magicType : {show: true, type: ['line', 'bar']},
                                                    restore : {show: true},
                                                    saveAsImage : {show: true}
                                                }
                                            },
                                            calculable : true,
                                            xAxis : [
                                                {
                                                    type : 'category',
                                                    axisLabel: {
                                                       interval:0,
                                                       rotate:15
                                                    },
                                                    boundaryGap : false,
                                                    data:["2011","2012","2013"],

                                                }
                                            ],


                                            yAxis : [
                                                {
                                                    type : 'value',
                                                    name : 'pm25',
                                                    /*max:120,
                                                    min:-40,*/
                                                    axisLabel : {
                                                        formatter: '{value} μg/m³'
                                                    }
                                                }
                                            ],
                                            series : [
                                                {
                                                    name:'pm25(°C)',
                                                    type:'line',
                                                    symbol:'emptycircle',
                                                    data:[10,10,10,10,10,10,10]
                                                }
                                            ]
                                          };


                           //myChart2.showLoading();    //数据加载完之前先显示一段简单的loading动画
                           console.info(myChart2);
                           myChart2.setOption(option,true);
                           //myChart1.resize();
                           loadOption();
                           var refresh = loadOption();
                           setInterval(refresh, 10000);
                           myChart2.setOption(option,true);
                                  // 为echarts对象加载数据
                                  //myChart1.setOption(option);

                              }
                          );

                        var list;
                         function loadOption(){

                     //alert(0);
                          var pm25=[];        //温度数组（存放服务器返回的所有温度值）
                          //var hums=[];        //湿度数组
                          var dates=[];  //时间数组

                          $.ajax({    //使用JQuery内置的Ajax方法
                          type : "get",       //post请求方式
                          async : true,        //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                          url : "yindex3.jsp",    //请求发送到ShowInfoIndexServlet处
                          data : {name:"test"},        //请求内包含一个key为name，value为A0001的参数；服务器接收到客户端请求时通过request.getParameter方法获取该参数值
                          dataType : "json",        //返回数据形式为json
                          success : function(result) {
                              //请求成功时执行该函数内容，result即为服务器返回的json对象
                              //var json=eval("("+result+")");
                          list=result.record_list;

                              //alert(list);
                              if (list!= null && list.length > 0) {
                                     for(var i=0;i<list.length;i++){
                                        //tems.push(list[i].tem);        //挨个取出温度、湿度、压强等值并填入前面声明的温度、湿度、压强等数组
                                        pm25.push(list[i].pm25);
                                        dates.push(list[i].dataStr);
                                        //alert(list[i].dateStr);
                                     }
                                     myChart2.hideLoading();    //隐藏加载动画
                                      //myChart1.clear();
                                     var option = myChart2.getOption();
                                     option.xAxis[0]["data"]=dates;//改变坐标值
                                     option.series[0]["data"]=pm25;//改变坐标值
                                     //option.series[1]["data"]=hums;//改变坐标值
                                      myChart2.setOption(option,true);//设置图表对象的所有参数属性
                                     /*myChart1.setOption({        //载入数据
                                         xAxis: [
                                                {
                                                     type : 'category',
                                                     boundaryGap : false,
                                                     data:dates
                                                 }
                                                 ],
                                         series:[    //填入系列（内容）数据
                                                       {
                                                     // 根据名字对应到相应的系列
                                                     name: '温度',
                                                     data: tems
                                                 },
                                                       {
                                                     name: '湿度',
                                                     data: hums
                                                 }
                                        ],
                                     });*/
                                     //alert(0);

                              }
                              else {
                                  //返回的数据为空时显示提示信息
                                  alert("2图表请求数据为空，可能服务器暂未录入近七天的观测数据，您可以稍后再试！");
                                    myChart2.hideLoading();
                              }

                         },
                          error : function(errorMsg) {
                              //请求失败时执行该函数
                              alert("2图表请求数据失败，可能是服务器开小差了");
                              myChart2.hideLoading();
                          }
                      })
                      }
                      </script>
                        <div class="clearfix"> </div>
                    </div>
                    </div>


              </div> <!-- /.content-wrapper -->

        </div> <!-- /.content-wrapper -->

        <script src="js/vendor/jquery-1.11.0.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Preloader -->
        <script type="text/javascript">
            //<![CDATA[
            $(window).load(function() { // makes sure the whole site is loaded
                $('.loader-item').fadeOut(); // will first fade out the loading animation
                    $('#pageloader').delay(350).fadeOut('slow'); // will fade out the white DIV that covers the website.
                $('body').delay(350).css({'overflow-y':'visible'});
            })
            //]]>
        </script>

    </body>
</html>
